<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                                       http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">

    <changeSet author="marcos.vassoler" id="create-table-GARANTIA-INDICE">
        <createTable tableName="GARANTIA_INDICE">
            <column autoIncrement="${autoIncrement}" name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_GARANTIA_INDICE"/>
            </column>
            <column name="DATAINICIO" type="DATETIME"/>
            <column name="DATAFINAL" type="DATETIME"/>
            <column name="VALORFIXO" type="DECIMAL(19, 2)"/>
            <column name="FK_INDICE_ECONOMICO" type="BIGINT"/>
            <column name="FK_GARANTIA" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet author="marcos.vassoler" id="create-fk-GARANTIA-INDICE-ECONOMICO">
        <addForeignKeyConstraint baseColumnNames="FK_INDICE_ECONOMICO" baseTableName="GARANTIA_INDICE"
                                 constraintName="FK_GARANTIA_INDICE_ECONOMICO" referencedColumnNames="ID"
                                 referencedTableName="INDICEECONOMICO" deferrable="false" initiallyDeferred="false"
                                 onDelete="NO ACTION" onUpdate="NO ACTION"/>
    </changeSet>

    <changeSet author="marcos.vassoler" id="create-fk-GARANTIA">
        <addForeignKeyConstraint baseColumnNames="FK_GARANTIA" baseTableName="GARANTIA_INDICE"
                                 constraintName="FK_GARANTIA" referencedColumnNames="ID"
                                 referencedTableName="GARANTIA" deferrable="false" initiallyDeferred="false"
                                 onDelete="NO ACTION" onUpdate="NO ACTION"/>
    </changeSet>

    <changeSet author="marcos.vassoler" id="create-seq-GARANTIA_INDICE" dbms="${dbmsSequence}">
        <createSequence sequenceName="SEQ_GARANTIA_INDICE"/>
    </changeSet>

    <changeSet id="create-GARANTIA-INDICE-AUD" author="marcos.vassoler">
        <createTable tableName="GARANTIA_INDICE_AUD">
            <column name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_GARANTIA_INDICE_AUD"/>
            </column>
            <column name="ID_AUD" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_GARANTIA_INDICE_AUD"/>
            </column>
            <column name="TIPO_AUD" type="BIGINT"/>
            <column name="DATAINICIO" type="DATETIME"/>
            <column name="DATAFINAL" type="DATETIME"/>
            <column name="VALORFIXO" type="DECIMAL(19, 2)"/>
            <column name="FK_INDICE_ECONOMICO" type="BIGINT"/>
            <column name="FK_GARANTIA" type="BIGINT"/>
        </createTable>
    </changeSet>

    <changeSet author="marcos.vassoler" id="create-fk_FK_GARANTIA_INDICE_AUD">
        <addForeignKeyConstraint baseColumnNames="ID_AUD" baseTableName="GARANTIA_INDICE_AUD"
                                 constraintName="FK_GARANTIA_INDICE_AUD" referencedColumnNames="ID"
                                 referencedTableName="LOG_AUDITORIA" deferrable="false" initiallyDeferred="false"
                                 onDelete="NO ACTION" onUpdate="NO ACTION"/>
    </changeSet>
    <changeSet id="adicionar-coluna-valor-corrigido-tabela-garantia" author="marcos.vassoler">
        <addColumn tableName="GARANTIA">
            <column name="VALOR_CORRIGIDO" type="DECIMAL(19, 2)"/>
        </addColumn>
    </changeSet>
    <changeSet id="adicionar-coluna-valor-corrigido-tabela-garantia-aud" author="marcos.vassoler">
        <addColumn tableName="GARANTIA_AUD">
            <column name="VALOR_CORRIGIDO" type="DECIMAL(19, 2)"/>
        </addColumn>
    </changeSet>

    <changeSet id="addcolumn-correcao-monetaria-and-update" author="gabriel.ribeiro">
        <addColumn tableName="GARANTIA">
            <column name="APLICAR_CORRECAO_MONETARIA" type="BOOLEAN"/>
        </addColumn>
        <update tableName="GARANTIA">
            <column name="APLICAR_CORRECAO_MONETARIA" valueBoolean="FALSE"/>
        </update>
    </changeSet>

    <changeSet id="addcolumn-correcao-monetaria-garantia-aud" author="gabriel.ribeiro">
        <addColumn tableName="GARANTIA_AUD">
            <column name="APLICAR_CORRECAO_MONETARIA" type="BOOLEAN"/>
        </addColumn>
    </changeSet>

    <changeSet id="create-tabela-parametroglobal-aud" author="eloi.correia">
        <createTable tableName="PARAMETROGLOBAL_AUD">
            <column name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_PARAMETROGLOBAL_AUD"/>
            </column>
            <column name="ID_AUD" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_PARAMETROGLOBAL_AUD"/>
            </column>
            <column name="TIPO_AUD" type="INTEGER"/>
            <column name="chave" type="VARCHAR(200)"/>
            <column name="classe" type="VARCHAR(200)"/>
            <column name="descricao" type="TEXT"/>
            <column name="valor" type="TEXT"/>
        </createTable>
    </changeSet>

    <changeSet id="create-tabela-parametroespecifico-aud" author="eloi.correia">
        <createTable tableName="PARAMETROESPECIFICO_AUD">
            <column name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_PARAMETROESPECIFICO_AUD"/>
            </column>
            <column name="ID_AUD" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_PARAMETROESPECIFICO_AUD"/>
            </column>
            <column name="TIPO_AUD" type="INTEGER"/>
            <column name="FK_PESSOA" type="BIGINT"/>
            <column name="valor" type="VARCHAR(255)"/>
            <column name="FK_PARAMETROGLOBAL" type="BIGINT"/>
        </createTable>
    </changeSet>
</databaseChangeLog>